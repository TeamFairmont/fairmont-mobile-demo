{"version":3,"file":"CartPopover.js","sourceRoot":"","sources":["../../../scripts/components/CartPopover.tsx"],"names":[],"mappings":";;;;;;;IASA;QAAiC,+BAA8H;QAG3J;YAHJ,iBA6DC;YAzDO,iBAAO,CAAC;YAsCJ,sBAAiB,GAAG;gBACxB,KAAI,CAAC,GAAG,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC,CAAC;gBAC3F,KAAI,CAAC,GAAG,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC,CAAC;gBACzF,iBAAQ,CAAC,mBAAmB,EAAE,EAAC,MAAM,EAAE,KAAI,CAAC,KAAK,CAAC,MAAM,EAAE,OAAO,EAAE,KAAI,CAAC,KAAK,CAAC,YAAY,EAAC,EAAE,UAAC,MAAU;oBACpG,KAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;oBACnC,IAAI,OAAO,GAAO,KAAI,CAAC,GAAU,CAAC;oBAClC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;gBACnF,CAAC,CAAC,CAAC;YACP,CAAC,CAAA;YAEO,gBAAW,GAAG,UAAC,EAAQ;gBAC3B,GAAG,CAAC,YAAY,CAAC,KAAK,CAAC,6DAA6D,CAAC,CAAC;YAC1F,CAAC,CAAA;YAEO,iBAAY,GAAG,UAAC,EAAQ;gBAC5B,IAAI,OAAO,GAAO,KAAI,CAAC,GAAU,CAAC;gBAClC,OAAO,CAAC,IAAI,EAAE,CAAC;gBACf,QAAQ,CAAC,sBAAsB,CAAC,KAAI,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YAC5D,CAAC,CAAA;YAvDG,IAAI,CAAC,KAAK,GAAG;gBACT,WAAW,EAAC,EACJ;gBACR,UAAU,EAAC,CAAC;gBACZ,UAAU,EAAC,CAAC;gBACZ,KAAK,EAAC,CAAC;gBACP,OAAO,EAAC,CAAC;gBACT,QAAQ,EAAC,EAAE;aACd,CAAC;QACN,CAAC;QAED,4BAAM,GAAN;YAAA,iBAwBC;YAvBG,MAAM,CAAC,qBAAC,WAAW,IAAC,SAAS,EAAC,MAAM,EAAC,EAAE,EAAC,MAAM,EAAC,GAAG,EAAE,UAAC,CAAS,IAAK,OAAA,KAAI,CAAC,GAAG,GAAG,CAAC,EAAZ,CAAa,GAC5E,qBAAC,GAAG,IAAC,KAAK,EAAE,EAAC,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,QAAQ,EAAE,GAC/C,qBAAC,CAAC,SAAC,qBAAC,EAAE,SAAE,IAAI,CAAC,KAAK,CAAC,OAAQ,CAAK,CAAI,EACpC,qBAAC,CAAC,SACE,qBAAC,QAAQ,SACL,qBAAC,eAAe,qBAA4B,EAC3C,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,UAAC,CAAC,EAAE,CAAC;gBAC3B,MAAM,CAAC,oBAAC,2BAAY,GAAC,IAAI,EAAE,CAAC,CAAC,IAAK,EAAC,GAAG,EAAE,CAAE,EAAC,IAAI,EAAE,CAAC,CAAC,IAAK,EAAC,KAAK,EAAE,CAAC,CAAC,KAAM,EAAC,KAAK,EAAE,CAAC,CAAC,KAAM,EAAC,GAAG,EAAE,CAAC,CAAC,GAAI,EAAC,YAAY,EAAE,CAAC,CAAC,YAAa,EAAgB,CAAA;YACtJ,CAAC,CAAE,CACI,CACX,EACJ,qBAAC,CAAC,wBACc,IAAI,CAAC,KAAK,CAAC,QAAS,EAAA,qBAAC,EAAE,QAAE,iBACzB,IAAI,CAAC,KAAK,CAAC,QAAS,EAAA,qBAAC,EAAE,QAAE,YAC9B,IAAI,CAAC,KAAK,CAAC,GAAI,EAAA,qBAAC,EAAE,QAAE,EAC3B,qBAAC,MAAM,qBAAU,IAAI,CAAC,KAAK,CAAC,KAAM,CAAS,CAC3C,EACJ,qBAAC,CAAC,SACE,qBAAC,UAAU,IAAC,EAAE,EAAC,UAAU,cAAsB,OAC/C,qBAAC,UAAU,IAAC,EAAE,EAAC,OAAO,WAAmB,CACzC,CACF,CACI,CAAC;QACnB,CAAC;QAqBL,kBAAC;IAAD,CAAC,AA7DD,CAAiC,KAAK,CAAC,SAAS,GA6D/C;IA7DY,mBAAW,cA6DvB,CAAA","sourcesContent":["import {boltCall} from 'Shared'\nimport * as React from \"react\"\nimport * as ReactDOM from \"react-dom\"\nimport {CartListItem} from \"components/CartListItem\"\n\ndeclare var ons:any;\n\nexport interface Props { cartId:string, message:string, productToAdd:string }\n\nexport class CartPopover extends React.Component<Props,{ cartItems:Array<any>, subtotal:number, shipping:number, tax:number, total:number, promos:Array<any> }> {\n    private _el:Element;\n\n    constructor() {\n        super();\n        this.state = {\n            \"cartItems\":[\n                   ], \n            \"subtotal\":0,\n            \"shipping\":0,\n            \"tax\":0,\n            \"total\":0,\n            \"promos\":[]\n        };\n    }\n\n    render() {\n        return <ons-popover direction=\"down\" id=\"cart\" ref={(c:Element) => this._el = c}>\n            <div style={{padding: \"10px\", textAlign: \"center\"}}>\n                <p><h4>{this.props.message}</h4></p>\n                <p>\n                    <ons-list>\n                        <ons-list-header>Your Cart</ons-list-header>\n                        {this.state.cartItems.map((v, i)=>{\n                            return <CartListItem meta={v.meta} key={i} name={v.name} price={v.price} stock={v.stock} sku={v.sku} previewImage={v.previewImage}></CartListItem>\n                        })} \n                    </ons-list>\n                </p>\n                <p>\n                    Subtotal: ${this.state.subtotal}<br/>\n                    Shipping: ${this.state.shipping}<br/>\n                    Tax: ${this.state.tax}<br/>\n                    <strong>Total: ${this.state.total}</strong>\n                </p>\n                <p>\n                    <ons-button id=\"checkout\">Checkout</ons-button>&nbsp;\n                    <ons-button id=\"close\">Close</ons-button>\n                </p>\n            </div>\n        </ons-popover>;\n    }\n\n    private componentDidMount = () => {        \n        this._el.querySelector(\"#checkout\").addEventListener(\"click\", this.showMessage.bind(this));\n        this._el.querySelector(\"#close\").addEventListener(\"click\", this.closePopover.bind(this));\n        boltCall(\"mobile/adjustCart\", {cartId: this.props.cartId, product: this.props.productToAdd}, (result:any) => {\n            this.setState(result.return_value);\n            var popover:any = this._el as any;\n            popover.show(document.querySelector(\"#buybutton\").parentElement.parentElement);\n        });\n    }\n\n    private showMessage = (ev:Event) => {\n        ons.notification.alert(\"TODO: Normally this would navigate to the checkout process.\");\n    }\n\n    private closePopover = (ev:Event) => {\n        var popover:any = this._el as any;\n        popover.hide();\n        ReactDOM.unmountComponentAtNode(this._el.parentElement);\n    }\n}"]}